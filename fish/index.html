<!DOCTYPE html>
<html>
<head>
  <script src='js/jquery-1.6.2.js'></script>
  <script src='js/audiobuffer.js'></script>
</head>
<body>

  <style>
    #playmarker {
      width:0px;
      height:5px;
      background:#0f0;
      z-index:99999;
      transition:20ms width linear;
      position:fixed;
      top:0;
      left:0;
    }
    #webcam {
      visibility: hidden;
      display:none;
    }
  </style>


  <div id="playmarker"></div>

  <video id="webcam" autoplay></video>

  <canvas width="200" height="133" id="canvasElement"></canvas>
  <canvas width="200" height="133" id="canvasFiltered"></canvas>
  <canvas width="200" height="133" id="canvasOverlay"></canvas>
  
  <div id="log" style="position:absolute;top:10px;right:10px;">

  </div>

  <script type="text/javascript">
var context = new webkitAudioContext();
    
  var timeDelay = 50;

  var webCamActive = false;

  /*
    TODO
    - audio distortion
    - checking right hand side audio


   */


    var playmarker = document.getElementById("playmarker");

    var width = 200;
    var height = 133
    var activeColumn = -1;

    var rows = 8;
    var columns = 16;

    var currentMatrix = [];
    var previousMatrix = [];
    var matrix = [];

    for (var i = 0; i < rows; i++) {
      var arr = [];
      for (var j = 0; j < columns; j++) {
        arr.push(false);
      }
      matrix.push(arr);
    }



    var notes = [
      "tones/tone1.wav",
      "tones/tone2.wav",
      "tones/tone3.wav",
      "tones/tone4.wav",
      "tones/tone5.wav",
      "tones/tone6.wav",
      "tones/tone7.wav",
      "tones/tone8.wav",
    ];

    var context = initializeNewWebAudioContext();
    context.loadSound('tones/tone1.wav', 'tone1');
    context.loadSound('tones/tone2.wav', 'tone2');
    context.loadSound('tones/tone3.wav', 'tone3');
    context.loadSound('tones/tone4.wav', 'tone4');
    context.loadSound('tones/tone5.wav', 'tone5');
    context.loadSound('tones/tone6.wav', 'tone6');
    context.loadSound('tones/tone7.wav', 'tone7');
    context.loadSound('tones/tone8.wav', 'tone8');


    playNote = function(index) {
      if (index === -1 || !notes[index]) return;

      context.playSound('tone' + (index + 1));

    }

    var i = 0;

    var t = setInterval(function() {
      i++;
      i = i % 8



      playNote(i);
    }, 300);

</script>
</body>
</html>